<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Verses of Joy</title>
  <style>
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      /* Fixed background from GitHub */
      background: url('background.jpg') no-repeat center center fixed;
      background-size: cover;
      display: flex;
      align-items: center;
      justify-content: center;
      height: 100vh;
      margin: 0;
      padding: 20px;
    }

    .box {
      background: rgba(255, 255, 255, 0.90);
      border-radius: 16px;
      padding: 40px;
      max-width: 500px;
      width: 100%;
      box-shadow: 0 10px 25px rgba(0,0,0,0.2);
      text-align: center;
      backdrop-filter: blur(5px);
      display: flex;
      flex-direction: column;
      align-items: center;
    }

    /* Style for the cycling Firebase image */
    #featured-image {
      width: 100%;
      max-height: 300px;
      object-fit: cover;
      border-radius: 8px;
      margin-bottom: 25px;
      box-shadow: 0 4px 10px rgba(0,0,0,0.15);
      display: none; /* Hidden until loaded */
    }

    h2 {
      color: #2563eb;
      font-size: 1.5rem;
      margin-top: 0;
      margin-bottom: 20px;
      text-transform: uppercase;
      letter-spacing: 1px;
    }

    p#quote {
      font-size: 1.25em;
      color: #374151;
      line-height: 1.6;
      font-style: italic; /* Added italic for verses */
      margin-bottom: 10px;
    }

    .ref {
      margin-top: 10px;
      font-weight: bold;
      color: #4b5563;
      font-size: 1rem;
    }

    .error {
      color: #b91c1c;
      font-size: 0.9em;
      margin-top: 15px;
    }
  </style>
</head>
<body>

  <div class="box">
    <h2>Verses of Joy</h2>
    
    <img id="featured-image" src="" alt="Daily Photo" />

    <p id="quote">Loading...</p>
    <div class="ref" id="author"></div>
    <div class="error" id="error"></div>
  </div>

  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-app.js";
    import { getFirestore, collection, getDocs } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js";

    // --- YOUR REAL CONFIG ---
    const firebaseConfig = {
      apiKey: "AIzaSyCZkXMT0Hl-vyjC_ZD0Uzp6x5Q3ER4068I",
      authDomain: "joy-joy-90bfd.firebaseapp.com",
      databaseURL: "https://joy-joy-90bfd-default-rtdb.asia-southeast1.firebasedatabase.app",
      projectId: "joy-joy-90bfd",
      storageBucket: "joy-joy-90bfd.firebasestorage.app",
      messagingSenderId: "73763462084",
      appId: "1:73763462084:web:f959558f1fada2c01a2291",
      measurementId: "G-QLS5T56060"
    };

    const app = initializeApp(firebaseConfig);
    const db = getFirestore(app);

    let imageUrls = [];
    const imgElement = document.getElementById("featured-image");

    // 1. Load Images from Firestore
    async function loadImages() {
      try {
        // Change "photos" to whatever you named your collection in Firebase
        const querySnapshot = await getDocs(collection(db, "photos"));
        
        querySnapshot.forEach((doc) => {
          const data = doc.data();
          if (data.url) imageUrls.push(data.url);
        });

        if (imageUrls.length > 0) {
          cycleImage();
          setInterval(cycleImage, 10000); // 10 seconds
        }
      } catch (e) {
        console.error("Error loading images:", e);
      }
    }

    function cycleImage() {
      if (imageUrls.length === 0) return;
      const randomIndex = Math.floor(Math.random() * imageUrls.length);
      imgElement.src = imageUrls[randomIndex];
      imgElement.style.display = "block";
    }

    // 2. Load Quotes from JSON
    async function loadQuote() {
      const quoteEl = document.getElementById("quote");
      const authorEl = document.getElementById("author");

      try {
        const res = await fetch("quotes.json");
        if (!res.ok) throw new Error("File not found");
        
        const quotes = await res.json();
        const randomIndex = Math.floor(Math.random() * quotes.length);
        const q = quotes[randomIndex];

        quoteEl.textContent = `"${q.quote}"`; // Added quotes around the text
        authorEl.textContent = "â€” " + q.author;
      } catch (e) {
        quoteEl.textContent = "Unable to load the verse.";
        console.error(e);
      }
    }

    loadImages();
    loadQuote();
  </script>
</body>
</html>

